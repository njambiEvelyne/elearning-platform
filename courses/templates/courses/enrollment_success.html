{% extends 'base.html' %}

{% block title %}
    {% if already_enrolled %}
        Welcome Back - {{ course.title }}
    {% else %}
        Enrollment Successful - {{ course.title }}
    {% endif %}
{% endblock %}

{% block content %}
<style>
    body {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .enrollment-wrapper {
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px 0;
    }

    .enrollment-container {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-radius: 25px;
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        overflow: hidden;
        max-width: 800px;
        width: 100%;
        margin: 20px;
        position: relative;
    }

    .enrollment-container::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 6px;
        background: linear-gradient(90deg, #32CD32, #28a745, #20c997, #17a2b8);
        animation: shimmer 3s ease-in-out infinite;
    }

    @keyframes shimmer {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.7; }
    }

    .celebration-header {
        background: linear-gradient(135deg, #32CD32, #28a745);
        color: white;
        padding: 50px 40px;
        text-align: center;
        position: relative;
        overflow: hidden;
    }

    .celebration-header::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="confetti" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="5" cy="5" r="1" fill="rgba(255,255,255,0.2)"/><circle cx="15" cy="15" r="1" fill="rgba(255,255,255,0.1)"/><rect x="10" y="2" width="1" height="3" fill="rgba(255,255,255,0.15)"/><rect x="2" y="10" width="3" height="1" fill="rgba(255,255,255,0.15)"/></pattern></defs><rect width="100" height="100" fill="url(%23confetti)"/></svg>');
        opacity: 0.3;
        animation: float 6s ease-in-out infinite;
    }

    @keyframes float {
        0%, 100% { transform: translateY(0px); }
        50% { transform: translateY(-10px); }
    }

    .celebration-icon {
        font-size: 5rem;
        margin-bottom: 20px;
        display: block;
        animation: bounce 2s ease-in-out infinite;
        position: relative;
        z-index: 1;
    }

    @keyframes bounce {
        0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
        40% { transform: translateY(-10px); }
        60% { transform: translateY(-5px); }
    }

    .celebration-title {
        font-size: 2.8rem;
        font-weight: 700;
        margin-bottom: 15px;
        position: relative;
        z-index: 1;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
    }

    .celebration-subtitle {
        font-size: 1.3rem;
        opacity: 0.95;
        margin-bottom: 0;
        position: relative;
        z-index: 1;
        font-weight: 300;
    }

    .enrollment-content {
        padding: 50px 40px;
    }

    .welcome-message {
        text-align: center;
        margin-bottom: 40px;
    }

    .welcome-text {
        font-size: 1.4rem;
        color: #2c3e50;
        line-height: 1.6;
        margin-bottom: 20px;
    }

    .personal-message {
        background: linear-gradient(135deg, rgba(50, 205, 50, 0.1), rgba(40, 167, 69, 0.1));
        border-left: 4px solid #32CD32;
        padding: 25px;
        border-radius: 12px;
        margin-bottom: 40px;
        position: relative;
        overflow: hidden;
    }

    .personal-message::before {
        content: 'üíö';
        position: absolute;
        top: 15px;
        right: 20px;
        font-size: 2rem;
        opacity: 0.3;
    }

    .personal-message-text {
        font-size: 1.1rem;
        color: #2c3e50;
        line-height: 1.7;
        margin: 0;
        font-style: italic;
    }

    .course-info-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 25px;
        margin-bottom: 40px;
    }

    .info-card {
        background: rgba(255, 255, 255, 0.8);
        border: 2px solid rgba(50, 205, 50, 0.2);
        border-radius: 15px;
        padding: 25px;
        text-align: center;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }

    .info-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(90deg, #32CD32, #28a745);
        transform: scaleX(0);
        transition: transform 0.3s ease;
    }

    .info-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(50, 205, 50, 0.2);
        border-color: rgba(50, 205, 50, 0.4);
    }

    .info-card:hover::before {
        transform: scaleX(1);
    }

    .info-icon {
        font-size: 2.5rem;
        color: #32CD32;
        margin-bottom: 15px;
        display: block;
    }

    .info-title {
        font-size: 1.1rem;
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 8px;
    }

    .info-value {
        font-size: 1.3rem;
        font-weight: 700;
        color: #32CD32;
        margin-bottom: 5px;
    }

    .info-description {
        font-size: 0.9rem;
        color: #6c757d;
        margin: 0;
    }

    .action-buttons {
        display: flex;
        gap: 20px;
        justify-content: center;
        flex-wrap: wrap;
        margin-top: 40px;
    }

    .btn-primary {
        background: linear-gradient(135deg, #32CD32, #28a745);
        border: none;
        color: white;
        padding: 15px 35px;
        border-radius: 50px;
        font-weight: 600;
        text-decoration: none;
        transition: all 0.3s ease;
        font-size: 1.1rem;
        position: relative;
        overflow: hidden;
        box-shadow: 0 8px 20px rgba(50, 205, 50, 0.3);
    }

    .btn-primary::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: left 0.5s;
    }

    .btn-primary:hover {
        transform: translateY(-3px);
        box-shadow: 0 12px 30px rgba(50, 205, 50, 0.4);
        color: white;
        text-decoration: none;
    }

    .btn-primary:hover::before {
        left: 100%;
    }

    .btn-secondary {
        background: transparent;
        border: 2px solid #32CD32;
        color: #32CD32;
        padding: 13px 35px;
        border-radius: 50px;
        font-weight: 600;
        text-decoration: none;
        transition: all 0.3s ease;
        font-size: 1.1rem;
    }

    .btn-secondary:hover {
        background: #32CD32;
        color: white;
        text-decoration: none;
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(50, 205, 50, 0.3);
    }

    .motivational-quote {
        background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
        border-radius: 15px;
        padding: 30px;
        text-align: center;
        margin-top: 40px;
        position: relative;
        overflow: hidden;
    }

    .motivational-quote::before {
        content: '"';
        position: absolute;
        top: 10px;
        left: 20px;
        font-size: 4rem;
        color: rgba(50, 205, 50, 0.2);
        font-family: serif;
    }

    .quote-text {
        font-size: 1.2rem;
        color: #2c3e50;
        font-style: italic;
        line-height: 1.6;
        margin-bottom: 15px;
        position: relative;
        z-index: 1;
    }

    .quote-author {
        font-size: 1rem;
        color: #6c757d;
        font-weight: 500;
    }

    .progress-indicator {
        background: rgba(255, 255, 255, 0.9);
        border-radius: 15px;
        padding: 25px;
        margin-top: 30px;
        text-align: center;
    }

    .progress-title {
        font-size: 1.2rem;
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 15px;
    }

    .progress-bar-container {
        background: #e9ecef;
        height: 12px;
        border-radius: 10px;
        overflow: hidden;
        margin-bottom: 15px;
        position: relative;
    }

    .progress-bar {
        height: 100%;
        background: linear-gradient(90deg, #32CD32, #28a745);
        border-radius: 10px;
        width: 0%;
        transition: width 2s ease;
        position: relative;
    }

    .progress-bar::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
        animation: shimmer-progress 2s infinite;
    }

    @keyframes shimmer-progress {
        0% { transform: translateX(-100%); }
        100% { transform: translateX(100%); }
    }

    .progress-text {
        font-size: 0.95rem;
        color: #6c757d;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
        .celebration-header {
            padding: 40px 20px;
        }
        
        .celebration-title {
            font-size: 2.2rem;
        }
        
        .celebration-subtitle {
            font-size: 1.1rem;
        }
        
        .enrollment-content {
            padding: 40px 20px;
        }
        
        .course-info-grid {
            grid-template-columns: 1fr;
            gap: 20px;
        }
        
        .action-buttons {
            flex-direction: column;
            align-items: center;
        }
        
        .btn-primary,
        .btn-secondary {
            width: 100%;
            max-width: 300px;
        }
    }

    @media (max-width: 480px) {
        .celebration-icon {
            font-size: 4rem;
        }
        
        .celebration-title {
            font-size: 1.8rem;
        }
        
        .welcome-text {
            font-size: 1.2rem;
        }
    }
</style>

<div class="enrollment-wrapper">
    <div class="enrollment-container">
        <div class="celebration-header">
            {% if already_enrolled %}
                <span class="celebration-icon">üéì</span>
                <h1 class="celebration-title">Welcome Back!</h1>
                <p class="celebration-subtitle">You're already part of this amazing learning journey</p>
            {% else %}
                <span class="celebration-icon">üéâ</span>
                <h1 class="celebration-title">Congratulations!</h1>
                <p class="celebration-subtitle">You've successfully enrolled in {{ course.title }}</p>
            {% endif %}
        </div>
        
        <div class="enrollment-content">
            <div class="welcome-message">
                {% if already_enrolled %}
                    <p class="welcome-text">
                        Great to see you again, <strong>{{ user.first_name|default:user.username }}</strong>! 
                        You're already enrolled in this course and ready to continue your learning adventure.
                    </p>
                {% else %}
                    <p class="welcome-text">
                        Welcome to your learning journey, <strong>{{ user.first_name|default:user.username }}</strong>! 
                        We're thrilled to have you join this course and can't wait to see you succeed.
                    </p>
                {% endif %}
            </div>

            <div class="personal-message">
                {% if already_enrolled %}
                    <p class="personal-message-text">
                        "Every expert was once a beginner. Continue your journey with confidence and remember that 
                        every lesson brings you closer to mastery. Your dedication to learning is truly inspiring!"
                    </p>
                {% else %}
                    <p class="personal-message-text">
                        "The beautiful thing about learning is that no one can take it away from you. You've just 
                        taken the first step towards expanding your knowledge and skills. We believe in your potential 
                        and are here to support you every step of the way!"
                    </p>
                {% endif %}
            </div>

            <div class="course-info-grid">
                <div class="info-card">
                    <span class="info-icon">üìö</span>
                    <div class="info-title">Course</div>
                    <div class="info-value">{{ course.title }}</div>
                    <p class="info-description">Your chosen learning path</p>
                </div>
                
                <div class="info-card">
                    <span class="info-icon">üë®‚Äçüè´</span>
                    <div class="info-title">Instructor</div>
                    <div class="info-value">{{ instructor.first_name|default:instructor.username }}</div>
                    <p class="info-description">Your learning guide</p>
                </div>
                
                <div class="info-card">
                    <span class="info-icon">üìñ</span>
                    <div class="info-title">Lessons</div>
                    <div class="info-value">{{ lessons_count }}</div>
                    <p class="info-description">Learning modules available</p>
                </div>
                
                <div class="info-card">
                    <span class="info-icon">üìÖ</span>
                    <div class="info-title">Enrolled</div>
                    <div class="info-value">{{ enrollment.enrolled_at|date:"M d, Y" }}</div>
                    <p class="info-description">Your journey started</p>
                </div>
            </div>

            {% if not already_enrolled %}
                <div class="progress-indicator">
                    <div class="progress-title">üöÄ Your Learning Journey Begins!</div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="welcomeProgress"></div>
                    </div>
                    <p class="progress-text">Ready to start your first lesson</p>
                </div>
            {% endif %}

            <div class="action-buttons">
                {% if lessons_count > 0 %}
                    <a href="{% url 'courses:course_detail' course.id %}" class="btn-primary">
                        {% if already_enrolled %}
                            Continue Learning üìö
                        {% else %}
                            Start First Lesson üöÄ
                        {% endif %}
                    </a>
                {% endif %}
                <a href="{% url 'users:student_dashboard' %}" class="btn-secondary">
                    Go to Dashboard üè†
                </a>
            </div>

            <div class="motivational-quote">
                <p class="quote-text">
                    {% if already_enrolled %}
                        "Success is the sum of small efforts repeated day in and day out."
                    {% else %}
                        "The journey of a thousand miles begins with one step."
                    {% endif %}
                </p>
                <p class="quote-author">
                    {% if already_enrolled %}
                        ‚Äî Robert Collier
                    {% else %}
                        ‚Äî Lao Tzu
                    {% endif %}
                </p>
            </div>
        </div>
    </div>
</div>

<script>
    // Animate progress bar for new enrollments
    {% if not already_enrolled %}
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                document.getElementById('welcomeProgress').style.width = '100%';
            }, 1000);
        });
    {% endif %}

    // Add some celebration effects for new enrollments
    {% if not already_enrolled %}
        // Create floating particles effect
        function createParticle() {
            const particle = document.createElement('div');
            particle.style.cssText = `
                position: fixed;
                width: 6px;
                height: 6px;
                background: #32CD32;
                border-radius: 50%;
                pointer-events: none;
                z-index: 1000;
                left: ${Math.random() * window.innerWidth}px;
                top: ${window.innerHeight + 10}px;
                animation: float-up 3s ease-out forwards;
            `;
            
            document.body.appendChild(particle);
            
            setTimeout(() => {
                particle.remove();
            }, 3000);
        }

        // Add CSS for particle animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes float-up {
                to {
                    transform: translateY(-${window.innerHeight + 100}px) rotate(360deg);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // Create particles periodically
        let particleCount = 0;
        const particleInterval = setInterval(() => {
            if (particleCount < 20) {
                createParticle();
                particleCount++;
            } else {
                clearInterval(particleInterval);
            }
        }, 200);
    {% endif %}
</script>
{% endblock %}